# ZLK-mechanism-for-co-orbital-asteroids-of-terrestrial-planets-

This repository provides code and data accompanying the paper:

Carruba et al. (2026), Co-orbital asteroids of terrestrial planets affected by the von-Zeipel-Lidov-Kozai mechanism, Celestial Mechanics and Dynamical Astronomy (in press).  

We are providing references for three codes:  1) Horizons Orbital Elements Exporter, 2) REBOUND Simulator, 3) ZLK-state classifier.

# 1) Horizons Orbital Elements Exporter (horizons_query.py)

This repository contains a Python script that queries NASA‚Äôs **JPL Horizons** system for asteroid orbital elements and saves the results to a file called `Particles.el`.
The output format is designed to be simple, precise, and reusable in orbital simulations, numerical experiments, or post-processing pipelines.

## üìå What This Code Does

- Queries **NASA JPL Horizons** using the `astroquery` library
- Retrieves **Keplerian orbital elements** for a list of asteroids
- Evaluates the elements at a specified **Julian Date**
- Writes the results to a plain-text file (`Particles.el`)
- Preserves high numerical precision suitable for scientific use

## üìÇ Files in This Repository

| File | Description |
|----|----|
| `horizons_query.py` | Main Python script that performs the Horizons query and writes output |
| `Particles.el` | Output file generated by the script (created when the script is run) |
| `README.md` | This documentation file

## üõ∞Ô∏è Output File Format (`Particles.el`)
The output file has the following structure:  the first line reports the number of asteroids, while the subsequent lines display the Keplerian orbital elements a,e, inc, \Omega,\omega, M.

## üß∞ Requirements

You will need **Python 3.8+** and the following packages:

- `astroquery`
- `astropy`

Install them using pip:

```bash
pip3 install astroquery astropy
```

An active internet connection is required to query JPL Horizons.

You may wish to modify:

asteroid_ids = ['2025 PN7', '2025 SC', '2025 RB7']
epochs = 2460800.5
Observer location
location = '500@10'  # Earth
Refer to the JPL Horizons documentation for valid object identifiers, locations, and epochs.

## ‚ñ∂Ô∏è Usage

```bash
python3 horizons_query.py
```

# 2) REBOUND Simulator (REBOUND_Simulator.py)

This repository contains a Python script, REBOUND_Simulator.py, that simulates the long-term orbital evolution of asteroids under the gravitational influence of the Sun and major Solar System bodies. The code uses the REBOUND N-body integrator and orbital elements retrieved from JPL Horizons to study variations in eccentricity and argument of periapsis, with a focus on identifying Kozai‚ÄìLidov‚Äìtype behavior.

Asteroid orbital elements are read from a text file (Particles.el). For each asteroid, the script builds a full Solar System model, integrates the orbit over time, and records key orbital parameters. The results are saved as plots showing eccentricity versus argument of periapsis and the time evolution of the argument of periapsis.

## üß∞  Requirements

Python 3, rebound, numpy, matplotlib, astroquery, astropy, angles, tqdm

## ‚ñ∂Ô∏è Usage

1) Place asteroid elements in Particles.el, as obtained from the file horizons_query.py, in the same directory where you plan to run the simulation
2) Install dependencies.

3) Run:

```bash
python3 REBOUND_Simulator.py
```

4) Output figures (figure_XX.png) are generated in the working directory.

# 3) ZLK State Classifier (ZLK_state_classifier.py)

This repository contains a Python script for analyzing and classifying dynamical states using resonant angle time series data. The code processes simulation outputs, applies a low-pass Butterworth filter to isolate long-period behavior, and extracts diagnostic quantities such as libration amplitude, mean resonant angle, and dominant oscillation period.  The script automatically infers an index from the working directory name, processes multiple input files per run, and generates both filtered and osculating angle plots. A Fourier analysis is used to identify the dominant period of the filtered signal, and summary results are written to a text file.

## üìå Features

Butterworth low-pass filtering of resonant angles
Automated batch processing of simulation outputs
Time-series visualization and spectral analysis
Compact numerical summary for downstream classification

## üß∞ Requirements

Python 3 with NumPy, SciPy, Pandas, and Matplotlib.

## ‚ñ∂Ô∏è Usage

```bash
python3 ZLK_state_classifier.py
```

Place the script in a directory containing the required input files (res_arg_#) and run it directly. Output plots and a results.txt file will be generated automatically.
